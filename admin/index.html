<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Admin - VIDARELAX</title>
  <link rel="icon" type="image/png" href="../imagenes/logo.png" />

  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <!-- Estilos personalizados para el CMS -->
  <style>
body {
  margin: 0;
  padding: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif !important;
  background: #f8f9fa !important;
}

:root {
  --primary-color: #4A7C7E;
  --secondary-color: #C4A962;
  --accent-color: #6B9FA1;
  --text-color: #2c3e50;
  --bg-color: #ffffff;
  --sidebar-bg: #f8f9fa;
}

/* FORZAR estilos con !important y selectores más específicos */
div[class*="App"] {
  background: linear-gradient(135deg, #4A7C7E 0%, #6B9FA1 100%) !important;
}

div[class*="AppHeader"], 
header[class*="AppHeader"] {
  background: linear-gradient(135deg, #4A7C7E 0%, #6B9FA1 100%) !important;
  color: white !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
}

nav[class*="Sidebar"], 
div[class*="Sidebar"] {
  background: #f8f9fa !important;
  border-right: 1px solid #e0e0e0 !important;
}

/* Texto del sidebar en colores VIDARELAX */
nav[class*="Sidebar"] a,
nav[class*="Sidebar"] span {
  color: #4A7C7E !important;
}

/* Elementos activos del sidebar */
nav[class*="Sidebar"] a[aria-current="page"],
nav[class*="Sidebar"] a.active,
div[class*="SidebarItem-active"] {
  background: #4A7C7E !important;
  color: white !important;
}

/* Botones primarios */
button, 
input[type="submit"],
a[class*="Button"] {
  background: #4A7C7E !important;
  border-color: #4A7C7E !important;
  color: white !important;
  border-radius: 8px !important;
  transition: all 0.3s ease !important;
}

button:hover,
input[type="submit"]:hover,
a[class*="Button"]:hover {
  background: #6B9FA1 !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 12px rgba(74, 124, 126, 0.3) !important;
}

/* Cards de colecciones */
div[class*="CollectionCard"],
div[class*="Card"] {
  border-radius: 12px !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08) !important;
  transition: all 0.3s ease !important;
}

div[class*="CollectionCard"]:hover,
div[class*="Card"]:hover {
  transform: translateY(-4px) !important;
  box-shadow: 0 4px 16px rgba(0,0,0,0.12) !important;
}

/* Inputs y formularios */
input, textarea, select {
  border: 1px solid #e0e0e0 !important;
  border-radius: 8px !important;
  padding: 0.75rem !important;
}

input:focus, textarea:focus, select:focus {
  border-color: #4A7C7E !important;
  box-shadow: 0 0 0 3px rgba(74, 124, 126, 0.1) !important;
  outline: none !important;
}

/* Área principal de contenido */
main, 
div[class*="MainContent"] {
  background: white !important;
}

/* Logo en la sidebar */
div[class*="SidebarIcon"] {
  background: #4A7C7E !important;
  border-radius: 50% !important;
}

/* Scrollbar personalizada */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: #4A7C7E;
  border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
  background: #6B9FA1;
}

/* Animación de carga */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

body { animation: fadeIn 0.5s ease !important; }
</style>
</head>
<body>
  <!-- Decap CMS - VERSIÓN CORREGIDA -->
  <script src="https://unpkg.com/decap-cms@^3.1.2/dist/decap-cms.js"></script>

  <!-- Scripts de autenticación - SIN CMS.init() -->
 <script>
// Manejar autenticación
if (window.netlifyIdentity) {
  window.netlifyIdentity.on("init", user => {
    if (!user) {
      window.netlifyIdentity.on("login", () => {
        document.location.href = "/admin/";
      });
    }
  });
  
  // NUEVO: Redirección al cerrar sesión CON MENSAJE
  window.netlifyIdentity.on("logout", () => {
    // Mostrar mensaje amigable
    alert("Sesión cerrada. Regresando a la página principal de VIDARELAX...");
    
    // Redirigir después de 1 segundo
    setTimeout(() => {
      window.location.href = "https://vidarelax.com.co";
    }, 1000);
  });
}

// Ocultar loader cuando el CMS esté listo
window.addEventListener('load', () => {
  setTimeout(() => {
    const root = document.getElementById('nc-root');
    if (root) {
      root.classList.add('loaded');
    }
  }, 500);
});
</script>
</body>
</html>
