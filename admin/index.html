<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Admin - VIDARELAX</title>
  <link rel="icon" type="image/png" href="../images/logo.png" />

  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    /* Reset básico */
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f8f9fa;
    }

    /* Contenedor principal del CMS */
    #nc-root {
      width: 100%;
      height: 100vh;
      position: relative;
      background: #f8f9fa;
    }

    /* IMPORTANTE: Remover loader que causa problemas */
    /* No usar ::before ni ::after en #nc-root */

    /* Variables de color personalizadas */
    :root {
      --primary-color: #4A7C7E;
      --secondary-color: #C4A962;
      --accent-color: #6B9FA1;
      --text-color: #2c3e50;
      --bg-color: #ffffff;
      --sidebar-bg: #f8f9fa;
    }

    /* Personalización del header */
    [class*="AppHeader"],
    [class*="TopBar"] {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%) !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
    }

    /* Sidebar */
    [class*="Sidebar"],
    [class*="SidebarContainer"] {
      background: var(--sidebar-bg) !important;
      border-right: 1px solid #e0e0e0 !important;
    }

    /* Botones primarios */
    button[class*="Button"][class*="primary"],
    a[class*="Button"][class*="primary"] {
      background: var(--primary-color) !important;
      border-color: var(--primary-color) !important;
      transition: all 0.3s ease !important;
    }

    button[class*="Button"][class*="primary"]:hover,
    a[class*="Button"][class*="primary"]:hover {
      background: var(--accent-color) !important;
      border-color: var(--accent-color) !important;
      transform: translateY(-2px) !important;
      box-shadow: 0 4px 12px rgba(74, 124, 126, 0.3) !important;
    }

    /* Items activos del sidebar */
    [class*="SidebarItem"][class*="active"],
    [class*="NavLink"][class*="active"] {
      background: var(--primary-color) !important;
      color: white !important;
    }

    /* Cards de colección */
    [class*="CollectionCard"],
    [class*="Card"] {
      border-radius: 12px !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08) !important;
      transition: all 0.3s ease !important;
      background: white !important;
    }

    [class*="CollectionCard"]:hover,
    [class*="Card"]:hover {
      transform: translateY(-4px) !important;
      box-shadow: 0 4px 16px rgba(0,0,0,0.12) !important;
    }

    /* Inputs */
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="search"],
    textarea,
    select {
      border: 1px solid #e0e0e0 !important;
      border-radius: 8px !important;
      padding: 0.75rem !important;
      transition: all 0.3s ease !important;
      background: white !important;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--primary-color) !important;
      box-shadow: 0 0 0 3px rgba(74, 124, 126, 0.1) !important;
      outline: none !important;
    }

    /* Tabs */
    [class*="Tab"] {
      border-radius: 8px 8px 0 0 !important;
    }

    [class*="Tab"][class*="active"] {
      background: var(--primary-color) !important;
      color: white !important;
    }

    /* Área de contenido principal */
    [class*="MainContent"],
    [class*="ContentContainer"] {
      background: white !important;
      min-height: 100vh !important;
    }

    /* Scrollbar personalizada */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--accent-color);
    }

    /* Fix para que el contenido no desaparezca */
    [class*="App"],
    [class*="Container"] {
      width: 100% !important;
      height: 100% !important;
      position: relative !important;
      z-index: 1 !important;
    }

    /* Asegurar que todos los elementos sean visibles */
    div, section, main, aside {
      position: relative !important;
    }
  </style>
</head>
<body>
  <!-- Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

  <script>
    // Manejar autenticación
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }

    // Asegurar que el CMS se renderice correctamente
    window.addEventListener('load', () => {
      console.log('CMS loaded successfully');

      // Verificar que el root existe
      const root = document.getElementById('nc-root');
      if (root) {
        console.log('CMS root found');
        root.style.display = 'block';
        root.style.visibility = 'visible';
        root.style.opacity = '1';
      }
    });

    // Prevenir que los estilos se sobrescriban
    const observer = new MutationObserver(() => {
      const root = document.getElementById('nc-root');
      if (root && root.style.display === 'none') {
        root.style.display = 'block';
      }
    });

    // Observar cambios en el DOM
    observer.observe(document.body, {
      childList: true,
      subtree: true,
      attributes: true,
      attributeFilter: ['style']
    });

    // Registrar preview styles (opcional)
    if (window.CMS) {
      CMS.registerPreviewStyle('/css/style.css');
    }
  </script>
</body>
</html>
