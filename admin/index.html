<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Admin - VIDARELAX</title>
  <link rel="icon" type="image/png" href="../imagenes/logo.png" />

  <!-- CONFIGURACIÃ“N NETLIFY IDENTITY -->
  <script>
    if (window.location.hostname === 'vidarelax.com.co') {
      window.netlifyIdentityConfig = {
        url: 'https://radiant-kashata-fa9673.netlify.app/.netlify/identity'
      };
    }
  </script>
  
  <!-- Netlify Identity Widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
  <!-- Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.1.2/dist/decap-cms.js"></script>

  <!-- ESTILOS VIDARELAX POST-CARGA -->
  <script>
(function() {
  'use strict';

  // Esperar a que el CMS cargue completamente
  function waitForCMSAndApplyStyles() {
    const checkInterval = setInterval(() => {
      const cmsRoot = document.getElementById('nc-root');
      const sidebar = document.querySelector('[class*="Sidebar"]');
      const mainContent = document.querySelector('[class*="MainContent"]');
      
      if (cmsRoot && (sidebar || mainContent || cmsRoot.children.length > 0)) {
        console.log('âœ… CMS cargado - aplicando estilos VIDARELAX');
        clearInterval(checkInterval);
        
        setTimeout(() => {
          applyVidarelaxStyles();
          startContinuousApplication();
        }, 500);
      }
    }, 500);
    
    // Timeout de seguridad
    setTimeout(() => {
      clearInterval(checkInterval);
      applyVidarelaxStyles();
      startContinuousApplication();
    }, 15000);
  }

  function applyVidarelaxStyles() {
    // Inyectar estilos dinÃ¡micamente
    if (!document.getElementById('vidarelax-styles')) {
      const style = document.createElement('style');
      style.id = 'vidarelax-styles';
      style.innerHTML = `
        /* FORZAR FONDO PRINCIPAL */
        html, body {
          background: linear-gradient(135deg, #4A7C7E 0%, #6B9FA1 100%) !important;
          margin: 0 !important;
          padding: 0 !important;
          min-height: 100vh !important;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
        }

        /* CONTENEDOR PRINCIPAL DEL CMS */
        #nc-root,
        [data-testid="nc-app"],
        [class*="App"] {
          background: linear-gradient(135deg, #4A7C7E 0%, #6B9FA1 100%) !important;
          min-height: 100vh !important;
        }

        /* HEADER/BARRA SUPERIOR */
        [class*="AppHeader"],
        [class*="TopBar"],
        header {
          background: linear-gradient(135deg, #4A7C7E 0%, #6B9FA1 100%) !important;
          color: white !important;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
        }

        [class*="AppHeader"] *,
        [class*="TopBar"] *,
        header * {
          color: white !important;
          fill: white !important;
        }

        /* SIDEBAR */
        [class*="Sidebar"],
        nav[role="navigation"],
        aside {
          background: rgba(248, 249, 250, 0.95) !important;
          backdrop-filter: blur(10px) !important;
          border-right: 1px solid rgba(74, 124, 126, 0.2) !important;
          box-shadow: 2px 0 10px rgba(0,0,0,0.1) !important;
        }

        /* ENLACES DEL SIDEBAR */
        [class*="Sidebar"] a,
        [class*="Sidebar"] button,
        nav[role="navigation"] a,
        nav[role="navigation"] button,
        aside a,
        aside button {
          color: #4A7C7E !important;
          transition: all 0.3s ease !important;
          text-decoration: none !important;
        }

        /* ENLACES ACTIVOS */
        [class*="Sidebar"] a[aria-current="page"],
        [class*="Sidebar"] .active,
        [class*="Sidebar"] [class*="active"],
        nav[role="navigation"] [aria-current="page"],
        aside [aria-current="page"] {
          background: #4A7C7E !important;
          color: white !important;
          border-radius: 8px !important;
        }

        /* HOVER EN SIDEBAR */
        [class*="Sidebar"] a:hover,
        [class*="Sidebar"] button:hover,
        nav[role="navigation"] a:hover,
        aside a:hover {
          background: rgba(74, 124, 126, 0.1) !important;
          border-radius: 6px !important;
        }

        /* ÃREA PRINCIPAL */
        [class*="MainContent"],
        [class*="Content"],
        main,
        [role="main"] {
          background: white !important;
          border-radius: 12px 0 0 0 !important;
          box-shadow: -2px 0 10px rgba(0,0,0,0.1) !important;
        }

        /* BOTONES */
        button,
        [role="button"],
        input[type="submit"],
        input[type="button"] {
          background: #4A7C7E !important;
          color: white !important;
          border: 1px solid #4A7C7E !important;
          border-radius: 8px !important;
          padding: 8px 16px !important;
          transition: all 0.3s ease !important;
        }

        button:hover,
        [role="button"]:hover,
        input[type="submit"]:hover {
          background: #6B9FA1 !important;
          transform: translateY(-2px) !important;
          box-shadow: 0 4px 12px rgba(74, 124, 126, 0.3) !important;
        }

        /* CARDS */
        [class*="Card"],
        [class*="CollectionCard"],
        article {
          background: white !important;
          border-radius: 12px !important;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08) !important;
          border: 1px solid rgba(74, 124, 126, 0.1) !important;
          transition: all 0.3s ease !important;
        }

        [class*="Card"]:hover,
        [class*="CollectionCard"]:hover {
          transform: translateY(-4px) !important;
          box-shadow: 0 8px 24px rgba(74, 124, 126, 0.2) !important;
        }

        /* INPUTS */
        input, textarea, select {
          border: 1px solid #e0e0e0 !important;
          border-radius: 8px !important;
          padding: 0.75rem !important;
          background: white !important;
          transition: all 0.3s ease !important;
        }

        input:focus, textarea:focus, select:focus {
          border-color: #4A7C7E !important;
          box-shadow: 0 0 0 3px rgba(74, 124, 126, 0.1) !important;
          outline: none !important;
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
          width: 10px !important;
        }
        ::-webkit-scrollbar-track {
          background: #f1f1f1 !important;
          border-radius: 10px !important;
        }
        ::-webkit-scrollbar-thumb {
          background: #4A7C7E !important;
          border-radius: 10px !important;
        }
        ::-webkit-scrollbar-thumb:hover {
          background: #6B9FA1 !important;
        }
      `;
      document.head.appendChild(style);
    }

    // Aplicar estilos directamente
    applyDirectStyles();
  }

  function applyDirectStyles() {
    const gradient = 'linear-gradient(135deg, #4A7C7E 0%, #6B9FA1 100%)';
    
    // HTML y BODY
    document.documentElement.style.background = gradient;
    document.body.style.background = gradient;
    document.body.style.margin = '0';
    document.body.style.padding = '0';
    document.body.style.minHeight = '100vh';
    
    // Contenedores principales
    const containers = document.querySelectorAll('#nc-root, [data-testid="nc-app"], [class*="App"]');
    containers.forEach(el => {
      if (el) {
        el.style.background = gradient;
        el.style.minHeight = '100vh';
        el.style.width = '100%';
      }
    });

    // Headers
    const headers = document.querySelectorAll('[class*="AppHeader"], [class*="TopBar"], header');
    headers.forEach(el => {
      if (el) {
        el.style.background = gradient;
        el.style.color = 'white';
        
        const headerChildren = el.querySelectorAll('*');
        headerChildren.forEach(child => {
          child.style.color = 'white';
          child.style.fill = 'white';
        });
      }
    });

    // Sidebars
    const sidebars = document.querySelectorAll('[class*="Sidebar"], nav[role="navigation"], aside');
    sidebars.forEach(el => {
      if (el && el.offsetWidth < 400) {
        el.style.background = 'rgba(248, 249, 250, 0.95)';
        el.style.backdropFilter = 'blur(10px)';
        el.style.borderRight = '1px solid rgba(74, 124, 126, 0.2)';
        el.style.boxShadow = '2px 0 10px rgba(0,0,0,0.1)';
      }
    });

    // Contenido principal
    const mainContent = document.querySelectorAll('[class*="MainContent"], [class*="Content"], main, [role="main"]');
    mainContent.forEach(el => {
      if (el && el.offsetWidth > 400) {
        el.style.background = 'white';
        el.style.borderRadius = '12px 0 0 0';
        el.style.boxShadow = '-2px 0 10px rgba(0,0,0,0.1)';
      }
    });
  }

  function startContinuousApplication() {
    // Aplicar cada 3 segundos por 2 minutos
    let count = 0;
    const interval = setInterval(() => {
      applyDirectStyles();
      count++;
      if (count >= 40) {
        clearInterval(interval);
        // Continuar cada 10 segundos
        setInterval(applyDirectStyles, 10000);
      }
    }, 3000);
  }

  // CONFIGURAR NETLIFY IDENTITY
  function setupIdentity() {
    if (window.netlifyIdentity) {
      if (window.location.hostname === 'vidarelax.com.co') {
        window.netlifyIdentity.init({
          APIUrl: 'https://radiant-kashata-fa9673.netlify.app/.netlify/identity'
        });
      }

      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
      
      window.netlifyIdentity.on("logout", () => {
        alert("SesiÃ³n cerrada. Regresando a la pÃ¡gina principal de VIDARELAX...");
        setTimeout(() => {
          window.location.href = "https://www.vidarelax.com.co/";
        }, 1000);
      });
    }
  }

  // INICIALIZAR TODO
  waitForCMSAndApplyStyles();
  setupIdentity();

  console.log('ðŸŽ¨ VIDARELAX CMS - Sistema simplificado activado');

})();
</script>
</body>
</html>
